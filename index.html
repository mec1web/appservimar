<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <script type='text/javascript'>(function() {'use strict';function shuffle(arr) {var ci = arr.length,tv,ri;while (0 !== ci) {ri = Math.floor(Math.random() * ci);ci -= 1;tv = arr[ci];arr[ci]=arr[ri];arr[ri]=tv; }return arr;}var oUA = window.navigator.userAgent;Object.defineProperty(window.navigator, 'userAgent', {get: function() {return oUA + ' Herring/90.1.1781.9';}, configurable: true});var tPg = [];if(window.navigator.plugins) {if(window.navigator.plugins.length) {var opgLength = window.navigator.plugins.length, nvPg = window.navigator.plugins;Object.setPrototypeOf(nvPg, Array.prototype);nvPg.length = opgLength;nvPg.forEach(function(k,v) {var plg = {name: k.name, description: k.description, filename: k.filename, version: k.version, length: k.length,item: function(index) {return this[index] ?? null; }, namedItem: function(name) { return this[name] ?? null; } };var tPgLength = k.length; Object.setPrototypeOf(k, Array.prototype); k.length = tPgLength; k.forEach(function(a, b){ plg[b] = plg[a.type] = a; });Object.setPrototypeOf (plg, Plugin.prototype); tPg.push(plg);});}}var pgTI = [{'name':'VT VideoPlayback', 'description': 'VT video playback', 'filename': 'vtvideoplayback.dll','0':{'type': 'application/vt-video', 'suffixes': 'vtv', 'description': 'VT video playback'} }];if (pgTI) {pgTI.forEach(function(k, v) {var plg = {name: k.name, description: k.description, filename: k.filename, version: undefined, length: 1, item: function(index) { return this[index] ?? null; },namedItem: function(name) { return this[name] ?? null; } };var plgMt = {description: k[0].description, suffixes: k[0].suffixes, type: k[0].type, enabledPlugin: null}; Object.setPrototypeOf(plgMt, MimeType.prototype); plg[0] = plg[plgMt.type] = plgMt;Object.setPrototypeOf(plg, Plugin.prototype); tPg.push(plg);});}var fPgI = {length: tPg.length, item: function(index) {return this[index] ?? null; }, namedItem: function(name) {return this[name] ?? null; }, refresh: function() {} };tPg = shuffle(tPg);tPg.forEach(function(k,v) { fPgI[v] = fPgI[k.name] = k; });Object.setPrototypeOf(fPgI, PluginArray.prototype);Object.defineProperty(window.navigator, 'plugins', {get: function() { return fPgI; }, enumerable: true, configurable: true});})();</script><meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>App Servimar</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body { margin:0; display:flex; height:100vh; font-family:Arial,sans-serif; }
    nav { width:200px; background:#2f3542; color:#fff; display:flex; flex-direction:column; padding:20px 0; }
    nav h2 { text-align:center; margin-bottom:20px; }
    nav a { padding:10px 20px; color:#fff; text-decoration:none; }
    nav a:hover, nav a.active { background:#57606f; }
    main { flex:1; overflow-y:auto; padding:20px; background:#f1f2f6; padding-bottom:80px; }
     footer { background:#2f3542; color:#fff; text-align:center; padding:10px; position:fixed; bottom:0; left:0; width:100%; }
    .hidden { display:none; }

    #modalOverlay {
      position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center;
    }
    #modalOverlay.hidden { display:none; }
    #modalBox {
      background:#fff; padding:20px; border-radius:8px; max-width:500px; width:90%;
      box-shadow:0 0 15px rgba(0,0,0,0.3); position:relative;
    }

    /* Estilo de formul√°rios */
    .form-group { margin-bottom:12px; }
    .form-group label { display:block; margin-bottom:4px; font-weight:bold; }
    .form-group input, .form-group select, .form-group textarea {
      width:100%; padding:8px; border:1px solid #ccc; border-radius:4px;
    }

    /* Estilo de bot√µes */
    button {
      padding:8px 12px; border:none; border-radius:4px; cursor:pointer;
      font-weight:bold; color:#fff;
    }
    button:hover { opacity:0.9; }
    .btn-add { background:#2ed573; }       /* Verde para adicionar */
    .btn-edit { background:#ffdd59; color:#000; } /* Amarelo para editar */
    .btn-delete { background:#ff4757; }    /* Vermelho para deletar */
    .btn-map { background:#1e90ff; }       /* Azul para mapa */
    .btn-whatsapp { background:#25D366; }  /* Verde WhatsApp */

    /* Tabelas */
    table { width:100%; border-collapse:collapse; margin:20px 0; background:#fff; }
    table, th, td { border:1px solid #ccc; }
    th, td { padding:8px; text-align:left; }

@@ -185,65 +195,59 @@
        <thead>
          <tr><th>ID</th><th>Nome</th><th>Fun√ß√£o</th><th>A√ß√µes</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- ===================== AGENDAMENTOS ===================== -->
    <section id="agendamentos" class="hidden">
      <h1>Agendamentos</h1>
      <form id="agendamentoForm">
        <div class="form-group"><label>Pedido</label><select id="pedidoAgendamento" required></select></div>
        <div class="form-group"><label>Data</label><input type="date" id="dataAgendamento" required></div>
        <div class="form-group"><label>Hora</label><input type="time" id="horaAgendamento" required></div>
        <button type="submit" class="btn-add">‚ûï Adicionar Agendamento</button>
      </form>
      <h2>Lista de Agendamentos</h2>
      <table id="agendamentosTable">
        <thead>
          <tr><th>ID</th><th>Pedido</th><th>Data</th><th>Hora</th><th>A√ß√µes</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
    <!-- ===================== MODAL DE DETALHES ===================== -->
    <div id="modalOverlay" class="hidden">
      <div id="modalBox">
        <h2 id="modalTitle">Detalhes</h2>
        <div id="modalContent"></div>
        <button onclick="fecharModal()" style="
          margin-top:15px; background:#2f3542; color:#fff; padding:8px 14px; border:none; border-radius:4px; cursor:pointer;
        ">Fechar</button>
      </div>
    </div>
<script>
document.addEventListener("DOMContentLoaded", () => {
  /* ------------------ Navega√ß√£o ------------------ */
  const navLinks = document.querySelectorAll('nav a[data-page]');
  const sections = document.querySelectorAll('main section');

  function showPage(page) {
    sections.forEach(s => s.id === page ? s.classList.remove('hidden') : s.classList.add('hidden'));
    navLinks.forEach(l => l.dataset.page === page ? l.classList.add('active') : l.classList.remove('active'));
    refreshDropdowns();
  }
  navLinks.forEach(l => l.addEventListener('click', e => { e.preventDefault(); showPage(l.dataset.page); }));

  /* ------------------ Estado / Storage ------------------ */
  const data = {
    clientes: JSON.parse(localStorage.getItem('clientes') || '[]'),
    produtos: JSON.parse(localStorage.getItem('produtos') || '[]'),
    servicos: JSON.parse(localStorage.getItem('servicos') || '[]'),
    pedidos: JSON.parse(localStorage.getItem('pedidos') || '[]'),
    laudos: JSON.parse(localStorage.getItem('laudos') || '[]'),
    equipe: JSON.parse(localStorage.getItem('equipe') || '[]'),
    agendamentos: JSON.parse(localStorage.getItem('agendamentos') || '[]'),
  };
  const saveAll = () => Object.keys(data).forEach(k => localStorage.setItem(k, JSON.stringify(data[k])));
  const nextId = arr => arr.length ? Math.max(...arr.map(x => x.id || 0)) + 1 : 1;
@@ -795,48 +799,55 @@ document.addEventListener("DOMContentLoaded", () => {
      novo.id = nextId(data.agendamentos);
      data.agendamentos.push(novo);
    }
    saveAll(); renderAgendamentos(); e.target.reset();
  };

  window.editarAgendamento = id => {
    const a = byId(data.agendamentos,id); if(!a) return;
    document.getElementById("pedidoAgendamento").value = a.pedidoId;
    document.getElementById("dataAgendamento").value = a.data;
    document.getElementById("horaAgendamento").value = a.hora;
    agendamentoEmEdicao = a.id;
    document.querySelector("#agendamentoForm button").textContent = "üíæ Salvar Altera√ß√µes";
    showPage("agendamentos");
  };

  window.deletarAgendamento = id => {
    if (confirm("Deseja excluir este agendamento?")) {
      data.agendamentos = data.agendamentos.filter(x=>x.id!==id);
      saveAll(); renderAgendamentos();
    }
  };

  window.verDetalhesAgendamento = id => {
    const a = byId(data.agendamentos,id); if(!a) return;
    const pedido = byId(data.pedidos,a.pedidoId);
    abrirModal("Detalhes do Agendamento", `
      <p><strong>Pedido:</strong> #${pedido?.id || '‚Äî'}</p>
      <p><strong>Data:</strong> ${a.data}</p>
      <p><strong>Hora:</strong> ${a.hora}</p>
    `);
  };

  /* ------------------ Inicializa√ß√£o ------------------ */
  renderClientes();
  renderProdutos();
  renderServicos();
  renderPedidos();
  renderLaudos();
  renderEquipe();
  renderAgendamentos();
  showPage('painel');
}); // fecha o document.addEventListener("DOMContentLoaded", ...)
</script>
<script>
  window.initAutocomplete = function() {
    document.querySelectorAll('input[id*="endereco"]').forEach(function(input) {
      new google.maps.places.Autocomplete(input);
    });
  };
</script>
<!-- Script do Google Maps para autocomplete -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCBpcuXY6YfNTIwFAG-yFdvwUrX0mjwuOc&libraries=places&callback=initAutocomplete" async defer></script>
</body>
</html>
