<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App Servimar</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2f3542">
  <style>
    body { margin: 0; font-family: Arial, sans-serif; display: flex; height: 100vh; }
    nav { width: 250px; background: #2f3542; color: #fff; display: flex; flex-direction: column; padding: 20px 0; }
    nav h2 { text-align: center; margin-bottom: 20px; }
    nav a { padding: 10px 20px; color: #fff; text-decoration: none; display: block; }
    nav a:hover, nav a.active { background: #57606f; }
    main { flex: 1; padding: 20px; background: #f1f2f6; overflow-y: auto; padding-bottom: 100px; }
    footer { background: #2f3542; color: #fff; text-align: center; padding: 10px; position: fixed; bottom: 0; left: 250px; right: 0; }
    .hidden { display: none; }
    .form-group { margin-bottom: 10px; }
    .form-group label { display: block; margin-bottom: 5px; }
    .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px; }
    textarea { min-height: 80px; }
    button { padding: 10px 15px; background: #2f3542; color: #fff; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #57606f; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; margin-bottom: 40px; }
    table, th, td { border: 1px solid #ccc; }
    th, td { padding: 10px; text-align: left; }
    .map-link a { color: #1e90ff; text-decoration: none; }
    .map-link a:hover { text-decoration: underline; }
    .whatsapp-link a { color: #25D366; font-weight: bold; text-decoration: none; }
    .whatsapp-link a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <!-- MENU -->
  <nav>
    <h2>Servimar</h2>
    <a href="#" onclick="showPage('painel', this)" class="active">Painel</a>
    <a href="#" onclick="showPage('clientes', this)">Clientes</a>
    <a href="#" onclick="showPage('pedidos', this)">Pedidos</a>
    <a href="#" onclick="showPage('laudos', this)">Laudos</a>
    <a href="#" onclick="showPage('equipe', this)">Equipe</a>
    <a href="#" onclick="showPage('agendamentos', this)">Agendamentos</a>
  </nav>

  <!-- CONTEÚDO -->
  <main>
    <section id="painel">
      <h1>Painel</h1>
      <p>Resumo geral do app.</p>
    </section>

    <!-- CLIENTES -->
    <section id="clientes" class="hidden">
      <h1>Clientes</h1>
      <form id="clienteForm">
        <div class="form-group"><label>Nome</label><input type="text" id="nome" required></div>
        <div class="form-group"><label>Email</label><input type="email" id="email"></div>
        <div class="form-group"><label>Telefone</label><input type="text" id="telefone" value="+55" required></div>
        <div class="form-group"><label>Endereço</label><input type="text" id="endereco" required></div>
        <div class="form-group"><label>Complemento</label><input type="text" id="complemento"></div>
        <button type="submit">Adicionar Cliente</button>
      </form>
      <h2>Lista</h2>
      <table id="clientesTable">
        <thead><tr><th>Nome</th><th>Email</th><th>Telefone</th><th>WhatsApp</th><th>Endereço</th><th>Compl.</th><th>Mapa</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- PEDIDOS -->
    <section id="pedidos" class="hidden">
      <h1>Pedidos</h1>
      <form id="pedidoForm">
        <div class="form-group"><label>Cliente</label><select id="clientePedido" required></select></div>
        <div class="form-group"><label>Status</label>
          <select id="statusPedido"><option>Orçamento</option><option>Aprovado</option><option>Em Andamento</option><option>Finalizado</option><option>Cancelado</option></select>
        </div>
        <h3>Serviços</h3>
        <table id="servicosTable"><thead><tr><th>Categoria</th><th>Serviço</th><th>Qtd</th><th>Valor</th><th>Subtotal</th></tr></thead><tbody></tbody></table>
        <button type="button" onclick="addServico()">+ Serviço</button>
        <h3>Produtos</h3>
        <table id="produtosTable"><thead><tr><th>Categoria</th><th>Produto</th><th>Qtd</th><th>Valor</th><th>Subtotal</th></tr></thead><tbody></tbody></table>
        <button type="button" onclick="addProduto()">+ Produto</button>
        <h3>Totais</h3>
        <p>Serviços: R$ <span id="totalServicos">0,00</span></p>
        <p>Produtos: R$ <span id="totalProdutos">0,00</span></p>
        <p><b>Total: R$ <span id="totalPedido">0,00</span></b></p>
        <button type="submit">Salvar Pedido</button>
      </form>
      <h2>Lista</h2>
      <table id="pedidosTable"><thead><tr><th>ID</th><th>Cliente</th><th>Status</th><th>Total</th></tr></thead><tbody></tbody></table>
    </section>

    <!-- LAUDOS -->
    <section id="laudos" class="hidden">
      <h1>Laudos</h1>
      <form id="laudoForm">
        <div class="form-group"><label>Pedido</label><select id="pedidoLaudo" required></select></div>
        <div class="form-group"><label>Tipo</label>
          <select id="tiposLaudo" multiple>
            <option>Vistoria</option><option>Relatório Técnico</option><option>Entrega de Obra</option><option>Inspeção Preventiva</option><option>Garantia</option>
          </select>
        </div>
        <div class="form-group"><label>Título</label><input type="text" id="tituloLaudo" required></div>
        <div class="form-group"><label>Descrição</label><textarea id="descricaoProblema"></textarea></div>
        <div class="form-group"><label>Procedimentos</label><textarea id="procedimentos"></textarea></div>
        <div class="form-group"><label>Recomendações</label><textarea id="recomendacoes"></textarea></div>
        <button type="submit">Salvar Laudo</button>
      </form>
      <h2>Lista</h2>
      <table id="laudosTable"><thead><tr><th>ID</th><th>Pedido</th><th>Tipos</th><th>Título</th><th>Data</th></tr></thead><tbody></tbody></table>
    </section>

    <!-- EQUIPE -->
    <section id="equipe" class="hidden">
      <h1>Equipe</h1>
      <form id="equipeForm">
        <div class="form-group"><label>Nome</label><input type="text" id="nomeEquipe" required></div>
        <div class="form-group"><label>Função</label><input type="text" id="funcaoEquipe"></div>
        <button type="submit">Adicionar</button>
      </form>
      <h2>Lista</h2>
      <table id="equipeTable"><thead><tr><th>Nome</th><th>Função</th></tr></thead><tbody></tbody></table>
    </section>

    <!-- AGENDAMENTOS -->
    <section id="agendamentos" class="hidden">
      <h1>Agendamentos</h1>
      <form id="agendamentoForm">
        <div class="form-group"><label>Pedido</label><select id="pedidoAgendamento" required></select></div>
        <div class="form-group"><label>Data</label><input type="date" id="dataAgendamento" required></div>
        <div class="form-group"><label>Hora</label><input type="time" id="horaAgendamento" required></div>
        <div class="form-group"><label>Responsável</label><select id="responsavelAgendamento" required></select></div>
        <div class="form-group"><label>Observações</label><textarea id="obsAgendamento"></textarea></div>
        <button type="submit">Salvar</button>
      </form>
      <h2>Lista</h2>
      <table id="agendamentosTable"><thead><tr><th>ID</th><th>Pedido</th><th>Data</th><th>Hora</th><th>Responsável</th></tr></thead><tbody></tbody></table>
    </section>
  </main>

  <footer>© 2025 Servimar</footer>

  <script>
    // NAV
    function showPage(pageId, element) {
      document.querySelectorAll('main section').forEach(s => s.classList.add('hidden'));
      document.getElementById(pageId).classList.remove('hidden');
      document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
      element.classList.add('active');
      if (pageId==='pedidos') updateClientesDropdown();
      if (pageId==='laudos') updatePedidosDropdown();
      if (pageId==='agendamentos') { updatePedidosAgendamento(); updateEquipeDropdown(); }
    }

    // CLIENTES
    let clientes = [];
    document.getElementById('clienteForm').addEventListener('submit', e=>{
      e.preventDefault();
      const nome=document.getElementById('nome').value;
      const email=document.getElementById('email').value;
      const telefone=document.getElementById('telefone').value;
      const endereco=document.getElementById('endereco').value;
      const complemento=document.getElementById('complemento').value;
      clientes.push({nome,email,telefone,endereco,complemento});
      const mapUrl=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(endereco+' '+complemento)}`;
      const whatsappUrl=`https://wa.me/${telefone.replace(/\\D/g,'')}`;
      document.querySelector('#clientesTable tbody').innerHTML+=`<tr><td>${nome}</td><td>${email}</td><td>${telefone}</td>
      <td class='whatsapp-link'><a href='${whatsappUrl}' target='_blank'>WhatsApp</a></td><td>${endereco}</td><td>${complemento}</td>
      <td class='map-link'><a href='${mapUrl}' target='_blank'>Ver no mapa</a></td></tr>`;
      e.target.reset(); document.getElementById('telefone').value='+55';
    });

    // PEDIDOS
    let pedidos=[]; let pedidoId=1;
    function updateClientesDropdown(){let dd=document.getElementById('clientePedido');dd.innerHTML=\"\";clientes.forEach((c,i)=>{dd.innerHTML+=`<option value='${i}'>${c.nome}</option>`});}
    function addServico(){document.querySelector('#servicosTable tbody').innerHTML+=`<tr><td><input placeholder='Categoria'></td><td><input placeholder='Serviço'></td><td><input type=number value=1 min=1 onchange='calcTotais()'></td><td><input type=number value=0 min=0 step=0.01 onchange='calcTotais()'></td><td class='subtotal'>0</td></tr>`;}
    function addProduto(){document.querySelector('#produtosTable tbody').innerHTML+=`<tr><td><input placeholder='Categoria'></td><td><input placeholder='Produto'></td><td><input type=number value=1 min=1 onchange='calcTotais()'></td><td><input type=number value=0 min=0 step=0.01 onchange='calcTotais()'></td><td class='subtotal'>0</td></tr>`;}
    function calcTotais(){let ts=0,tp=0;document.querySelectorAll('#servicosTable tbody tr').forEach(r=>{let q=+r.children[2].children[0].value;let v=+r.children[3].children[0].value;let s=q*v;r.querySelector('.subtotal').textContent=s.toFixed(2);ts+=s;});document.querySelectorAll('#produtosTable tbody tr').forEach(r=>{let q=+r.children[2].children[0].value;let v=+r.children[3].children[0].value;let s=q*v;r.querySelector('.subtotal').textContent=s.toFixed(2);tp+=s;});document.getElementById('totalServicos').textContent=ts.toFixed(2);document.getElementById('totalProdutos').textContent=tp.toFixed(2);document.getElementById('totalPedido').textContent=(ts+tp).toFixed(2);}
    document.getElementById('pedidoForm').addEventListener('submit',e=>{e.preventDefault();const ci=document.getElementById('clientePedido').value;const cliente=clientes[ci]?.nome||\"-\";const status=document.getElementById('statusPedido').value;const total=document.getElementById('totalPedido').textContent;pedidos.push({id:pedidoId,cliente,status,total});document.querySelector('#pedidosTable tbody').innerHTML+=`<tr><td>${pedidoId}</td><td>${cliente}</td><td>${status}</td><td>R$ ${total}</td></tr>`;pedidoId++;e.target.reset();document.querySelector('#servicosTable tbody').innerHTML=\"\";document.querySelector('#produtosTable tbody').innerHTML=\"\";calcTotais();});

    // LAUDOS
    let laudos=[]; let laudoId=1;
    function updatePedidosDropdown(){let dd=document.getElementById('pedidoLaudo');dd.innerHTML=\"\";pedidos.forEach(p=>{dd.innerHTML+=`<option value='${p.id}'>Pedido ${p.id} - ${p.cliente}</option>`});}
    document.getElementById('laudoForm').addEventListener('submit',e=>{e.preventDefault();const pedido=document.getElementById('pedidoLaudo').value;const tipos=[...document.getElementById('tiposLaudo').selectedOptions].map(o=>o.value).join(\", \");const titulo=document.getElementById('tituloLaudo').value;const data=new Date().toLocaleDateString();laudos.push({id:laudoId,pedido,tipos,titulo,data});document.querySelector('#laudosTable tbody').innerHTML+=`<tr><td>${laudoId}</td><td>${pedido}</td><td>${tipos}</td><td>${titulo}</td><td>${data}</td></tr>`;laudoId++;e.target.reset();});

    // EQUIPE
    let equipe=[];document.getElementById('equipeForm').addEventListener('submit',e=>{e.preventDefault();const nome=document.getElementById('nomeEquipe').value;const funcao=document.getElementById('funcaoEquipe').value;equipe.push({nome,funcao});document.querySelector('#equipeTable tbody').innerHTML+=`<tr><td>${nome}</td><td>${funcao}</td></tr>`;e.target.reset();});

    // AGENDAMENTOS
    let agendamentos=[];let agendamentoId=1;
    function updatePedidosAgendamento(){let dd=document.getElementById('pedidoAgendamento');dd.innerHTML=\"\";pedidos.forEach(p=>{dd.innerHTML+=`<option value='${p.id}'>Pedido ${p.id} - ${p.cliente}</option>`});}
    function updateEquipeDropdown(){let dd=document.getElementById('responsavelAgendamento');dd.innerHTML=\"\";equipe.forEach((c,i)=>{dd.innerHTML+=`<option value='${i}'>${c.nome}</option>`});}
    document.getElementById('agendamentoForm').addEventListener('submit',e=>{e.preventDefault();const pedido=document.getElementById('pedidoAgendamento').value;const data=document.getElementById('dataAgendamento').value;const hora=document.getElementById('horaAgendamento').value;const resp=document.getElementById('responsavelAgendamento').value;const nomeResp=equipe[resp]?.nome||\"-\";agendamentos.push({id:agendamentoId,pedido,data,hora,resp:nomeResp});document.querySelector('#agendamentosTable tbody').innerHTML+=`<tr><td>${agendamentoId}</td><td>${pedido}</td><td>${data}</td><td>${hora}</td><td>${nomeResp}</td></tr>`;agendamentoId++;e.target.reset();});

    // Google Maps Autocomplete
    function initAutocomplete(){new google.maps.places.Autocomplete(document.getElementById(\"endereco\"));}
    if(\"serviceWorker\" in navigator){navigator.serviceWorker.register(\"service-worker.js\");}
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCBpcuXY6YfNTIwFAG-yFdvwUrX0mjwuOc&libraries=places&callback=initAutocomplete" async defer></script>
</body>
</html>
